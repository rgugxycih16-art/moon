<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸Šè‚¿ç—…ç†ä¼šè¯Š - æ™ºèƒ½å‘å¯¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        /* --- åŸºç¡€è®¾ç½® --- */
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background-color: #f8fafc;
            padding-top: 105px; 
        }
        @media (min-width: 768px) {
            body { padding-top: 64px; }
        }

        /* --- å¯¼èˆªæ æ ·å¼ --- */
        .glass-nav {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #e2e8f0;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        .nav-item {
            position: relative;
            color: #64748b;
            font-weight: 500;
            transition: all 0.2s;
        }
        .nav-item:hover { color: #0d9488; }
        .nav-item.active { color: #0f766e; }
        
        .mobile-tabs {
            overflow-x: auto;
            scrollbar-width: none;
        }
        .mobile-tabs::-webkit-scrollbar { display: none; }

        /* --- å›¾è¡¨ä¸åŠ¨ç”» --- */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 300px;
            height: 300px;
            margin: 0 auto;
        }
        .flow-node { transition: all 0.3s ease; }
        .active-path {
            border-color: #0d9488 !important;
            background-color: #f0fdfa !important;
            box-shadow: 0 4px 6px -1px rgba(13, 148, 136, 0.1);
            transform: scale(1.02);
        }
        #qrModal { transition: opacity 0.3s ease; }
        #qrModal.hidden { pointer-events: none; opacity: 0; }
        #qrModal:not(.hidden) { opacity: 1; pointer-events: auto; }
    </style>
</head>
<body class="text-slate-700">

    <!-- ================= å¯¼èˆªæ  ================= -->
    <nav class="glass-nav fixed top-0 w-full z-50">
        <div class="max-w-4xl mx-auto">
            <div class="h-14 px-4 flex justify-between items-center">
                <!-- å·¦ä¾§ï¼šæ ‡é¢˜ -->
                <div class="flex items-center gap-2">
                    <div class="bg-teal-600 text-white p-1.5 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                    </div>
                    <div>
                        <div class="font-bold text-slate-800 text-base leading-none">ä¸Šæµ·é™ªè¯Šå°æ²³åˆ¶ä½œ</div>
                        <div class="text-[10px] text-slate-400 mt-0.5">ğŸ“17898872018</div>
                    </div>
                </div>

                <!-- å³ä¾§ï¼šç”µè„‘ç«¯èœå• -->
                <div class="flex items-center gap-4">
                    <div class="hidden md:flex gap-5 text-sm font-medium">
                        <button onclick="scrollToSection('prep')" class="nav-item">å‡†å¤‡ææ–™</button>
                        <button onclick="scrollToSection('logic')" class="nav-item">ä¼šè¯ŠåŸç†</button>
                        <button onclick="scrollToSection('process')" class="nav-item">é€è¯Šæµç¨‹</button>
                        <button onclick="scrollToSection('result')" class="nav-item">ç»“æœæŸ¥è¯¢</button>
                        <button onclick="scrollToSection('mail')" class="nav-item">å¿«é€’é‚®å¯„</button>
                    </div>

                    <!-- ä¿®æ”¹ç‚¹ï¼šæŒ‰é’®æ–‡å­—ç»Ÿä¸€ä¸ºâ€œéœ€ä»£åŠ/å’¨è¯¢?â€ -->
                    <button onclick="openModal()" class="flex items-center gap-1.5 bg-amber-50 hover:bg-amber-100 text-amber-700 border border-amber-200 px-3 py-1.5 rounded-full transition-all text-xs md:text-sm font-bold shrink-0">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                        </svg>
                        <span>éœ€ä»£åŠ/å’¨è¯¢?</span>
                    </button>
                </div>
            </div>

            <!-- ä¸‹å±‚ï¼šç§»åŠ¨ç«¯èœå• -->
            <div class="md:hidden border-t border-slate-100 mobile-tabs">
                <div class="flex px-2 min-w-full">
                    <button onclick="scrollToSection('prep')" class="flex-none py-3 text-sm font-medium text-slate-600 px-4 border-b-2 border-transparent focus:text-teal-600 transition-colors">å‡†å¤‡ææ–™</button>
                    <button onclick="scrollToSection('logic')" class="flex-none py-3 text-sm font-medium text-slate-600 px-4 border-b-2 border-transparent focus:text-teal-600 transition-colors">ä¼šè¯ŠåŸç†</button>
                    <button onclick="scrollToSection('process')" class="flex-none py-3 text-sm font-medium text-slate-600 px-4 border-b-2 border-transparent focus:text-teal-600 transition-colors">é€è¯Šæµç¨‹</button>
                    <button onclick="scrollToSection('result')" class="flex-none py-3 text-sm font-medium text-slate-600 px-4 border-b-2 border-transparent focus:text-teal-600 transition-colors">ç»“æœæŸ¥è¯¢</button>
                    <button onclick="scrollToSection('mail')" class="flex-none py-3 text-sm font-medium text-slate-600 px-4 border-b-2 border-transparent focus:text-teal-600 transition-colors">å¿«é€’é‚®å¯„</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="bg-gradient-to-br from-teal-600 to-teal-800 text-white py-10 px-4 text-center">
        <div class="max-w-3xl mx-auto">
            <h1 class="text-2xl md:text-4xl font-bold mb-3">ç—…ç†ä¼šè¯ŠÂ·å…¨æµç¨‹å‘å¯¼</h1>
            <p class="text-teal-100 text-sm md:text-lg">ä¸ºæ‚¨æ¢³ç†å¤æ—¦å¤§å­¦é™„å±è‚¿ç˜¤åŒ»é™¢ï¼ˆä¸Šè‚¿ï¼‰é€åˆ‡ç‰‡çš„ææ–™å‡†å¤‡ã€ä¼šè¯Šæµç¨‹ä¸æ—¶é—´èŠ‚ç‚¹ã€‚</p>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 py-8 space-y-12">

        <!-- Section 1: Preparation -->
        <section id="prep" class="bg-white rounded-xl shadow-lg p-5 md:p-8">
            <div class="mb-6">
                <h2 class="text-xl md:text-2xl font-bold text-slate-800 flex items-center gap-2">
                    <span class="bg-teal-100 text-teal-800 text-xs md:text-sm px-2 py-1 rounded">ç¬¬ä¸€æ­¥</span>
                    å‡†å¤‡ææ–™ 
                </h2>
                <!-- æ–‡æ¡ˆ -->
                <div class="text-sm md:text-base text-slate-600 mt-3 space-y-3">
                    <p class="leading-relaxed">
                        è¿™æ˜¯æœ€å…³é”®çš„ä¸€æ­¥ã€‚è¯·å¯¹ç…§æ‰‹ä¸­çš„ææ–™ï¼Œå‹¾é€‰ä¸‹æ–¹çš„æ¸…å•ï¼Œ<span class="bg-teal-50 text-teal-700 px-1 font-bold border border-teal-100 rounded">æ ‡æœ‰åº•è‰²çš„é¡¹ç›®</span>ä¸ºé‡ç‚¹æ£€æŸ¥å¯¹è±¡ã€‚æˆ‘ä»¬ä¼šé€šè¿‡å›¾è¡¨æ˜¾ç¤ºæ‚¨çš„å‡†å¤‡å®Œæˆåº¦ã€‚
                    </p>
                    
                    <div class="bg-amber-50 border border-amber-100 rounded-md p-2.5 inline-block w-full md:w-auto">
                        <span class="font-bold text-amber-700 text-xs bg-amber-200 px-1.5 py-0.5 rounded mr-1">æç¤º</span>
                        <span class="text-amber-800 text-sm">æ‰€æœ‰çš„åˆ‡ç‰‡å’Œèµ„æ–™éƒ½éœ€è¦ä»åŸæ‰‹æœ¯/æ´»æ£€åŒ»é™¢å€Ÿå‡ºã€‚</span>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <!-- Checklist -->
                <div class="space-y-4">
                    <h3 class="font-semibold text-slate-700 border-b pb-2 text-sm md:text-base">æ ¸å¿ƒææ–™</h3>
                    <div class="space-y-3" id="checklist-container"></div>
                    
                    <h3 class="font-semibold text-slate-700 border-b pb-2 pt-4 text-sm md:text-base">å¯é€‰ææ–™</h3>
                    <div class="space-y-3" id="checklist-optional-container"></div>
                </div>

                <!-- Visualization -->
                <div class="flex flex-col items-center bg-slate-50 rounded-lg p-6">
                    <h3 class="font-semibold text-slate-700 mb-4 text-sm md:text-base">å‡†å¤‡å®Œæˆåº¦</h3>
                    <div class="chart-container">
                        <canvas id="readinessChart"></canvas>
                    </div>
                    <p id="readiness-text" class="mt-4 text-center text-sm font-medium text-slate-500">è¯·å‹¾é€‰å·¦ä¾§é¡¹ç›®</p>
                    <div id="missing-alert" class="hidden mt-2 p-2 bg-red-50 text-red-600 text-xs rounded w-full text-center font-bold">
                        ç¼ºå°‘HEåˆ‡ç‰‡æˆ–ç—…ç†æŠ¥å‘Šï¼Œæ— æ³•ä¼šè¯Šï¼
                    </div>
                </div>
            </div>
            <!-- Material Details -->
            <div class="mt-8 grid grid-cols-1 sm:grid-cols-3 gap-4">
                <div class="bg-purple-50 p-4 rounded border border-purple-100">
                    <div class="font-bold text-purple-800 mb-1 text-sm md:text-base">HE åˆ‡ç‰‡</div>
                    <div class="text-xs text-purple-600 mb-2">é€šå¸¸ä¸ºç´«è‰²</div>
                    <p class="text-xs md:text-sm text-slate-600">å¸¸è§„ç—…ç†è¯Šæ–­ï¼Œç”¨äºè§‚å¯Ÿç»„ç»‡ç»“æ„å’Œç»†èƒå½¢æ€ã€‚æ ‡ç­¾ä¸Šé€šå¸¸æœ‰ "HE" å­—æ ·ã€‚</p>
                </div>
                <div class="bg-amber-50 p-4 rounded border border-amber-100">
                    <div class="font-bold text-amber-800 mb-1 text-sm md:text-base">å…ç–«ç»„åŒ– (IHC)</div>
                    <div class="text-xs text-amber-600 mb-2">é€šå¸¸ä¸ºæ£•è‰²</div>
                    <p class="text-xs md:text-sm text-slate-600">æ ‡ç­¾ä¸Šæœ‰ ER, PR, Ki-67 ç­‰æŒ‡æ ‡ã€‚ç”¨äºæ˜ç¡®åˆ†å‹å’Œæ¥æºã€‚</p>
                </div>
                <div class="bg-slate-100 p-4 rounded border border-slate-200">
                    <div class="font-bold text-slate-800 mb-1 text-sm md:text-base">ç™½ç‰‡ / èœ¡å—</div>
                    <div class="text-xs text-slate-500 mb-2">é€æ˜/ç™½è‰²</div>
                    <p class="text-xs md:text-sm text-slate-600"><b> ç”¨äºä¸Šè‚¿åŠ åšæ£€æŸ¥ï¼Œç»è¿‡ä¸åŒæŸ“è‰²å¤„ç†åå³HEåˆ‡ç‰‡æˆ–å…ç–«ç»„åŒ–åˆ‡ç‰‡ã€‚æ”¶åˆ°åŠ é¡¹é€šçŸ¥å†é€è¿‡å»æˆ–è€…æå‰å‡†å¤‡</b>é«˜è´¨é‡æ¶‚èƒ¶ç™½ç‰‡ï¼ˆ15å¼ ï¼‰æˆ–åŸå§‹èœ¡å—ã€‚</p>
                </div>
            </div>
        </section>

        <!-- Section 2: Logic Simulator -->
        <section id="logic" class="bg-white rounded-xl shadow-lg p-5 md:p-8">
            <div class="mb-6">
                <h2 class="text-xl md:text-2xl font-bold text-slate-800 flex items-center gap-2">
                    <span class="bg-teal-100 text-teal-800 text-xs md:text-sm px-2 py-1 rounded">åŸç†</span>
                    åŒ»ç”Ÿæ€ä¹ˆçœ‹ç‰‡å­ï¼Ÿ
                </h2>
                <p class="text-sm md:text-base text-slate-500 mt-2">
                    å¾ˆå¤šå®¶å±ä¸æ¸…é™¤ä½•æ—¶éœ€è¦ç™½ç‰‡/èœ¡å—ã€‚é€šè¿‡ä¸‹æ–¹çš„äº’åŠ¨æµç¨‹å›¾ï¼Œç†è§£â€œç™½ç‰‡â€åœ¨ç—…ç†ä¼šè¯Šä¸­çš„ä½œç”¨ã€‚
                </p>
            </div>

            <div class="flex flex-wrap gap-3 mb-8 justify-center">
                <button onclick="setScenario('simple')" class="scenario-btn px-3 py-2 rounded-full border border-slate-300 hover:bg-slate-50 text-xs md:text-sm font-medium transition focus:ring-2 focus:ring-teal-500 focus:outline-none" id="btn-simple">
                    æƒ…æ™¯ A: å½¢æ€å…¸å‹ (ç®€å•)
                </button>
                <button onclick="setScenario('complex')" class="scenario-btn px-3 py-2 rounded-full border border-slate-300 hover:bg-slate-50 text-xs md:text-sm font-medium transition focus:ring-2 focus:ring-teal-500 focus:outline-none" id="btn-complex">
                    æƒ…æ™¯ B: éœ€è¦ç¡®è¯Š (å¤æ‚)
                </button>
                <button onclick="setScenario('redo')" class="scenario-btn px-3 py-2 rounded-full border border-slate-300 hover:bg-slate-50 text-xs md:text-sm font-medium transition focus:ring-2 focus:ring-teal-500 focus:outline-none" id="btn-redo">
                    æƒ…æ™¯ C: ç»“æœå­˜ç–‘ (é‡æµ‹)
                </button>
            </div>

            <div class="relative bg-slate-50 p-4 md:p-6 rounded-xl border border-slate-200 overflow-hidden">
                <div class="flex justify-center mb-8">
                    <div id="node-he" class="flow-node w-64 bg-white border-2 border-slate-300 p-4 rounded shadow-sm text-center z-10">
                        <div class="font-bold text-slate-700 text-sm md:text-base">1. å¸¸è§„ç—…ç†è¯Šæ–­ (HEåˆ‡ç‰‡)</div>
                        <div class="text-xs text-slate-500">åŒ»ç”Ÿåœ¨æ˜¾å¾®é•œä¸‹è§‚å¯Ÿå½¢æ€</div>
                    </div>
                </div>
                <!-- è¿æ¥çº¿ -->
                <div class="flex justify-center h-12 relative -mt-4 mb-4">
                    <div class="w-0.5 bg-slate-300 h-full"></div>
                </div>
                <!-- åˆ†æ”¯ -->
                <div class="grid grid-cols-2 gap-4 md:gap-8 relative">
                    <div class="flex flex-col items-center">
                        <div id="path-line-left" class="w-0.5 bg-slate-300 h-8 mb-2"></div>
                        <div id="node-report-fast" class="flow-node w-full max-w-xs bg-white border-2 border-slate-300 p-3 md:p-4 rounded shadow-sm text-center h-full flex flex-col justify-center">
                            <div class="font-bold text-slate-700 text-sm md:text-base">ç›´æ¥å‡ºæŠ¥å‘Š</div>
                            <div class="text-xs text-teal-600 font-bold mt-2 hidden scenario-text-simple">é¡ºåˆ©ï¼é€šå¸¸7å¤©å†…å‡ºç»“æœ</div>
                        </div>
                    </div>

                    <div class="flex flex-col items-center">
                        <div id="path-line-right" class="w-0.5 bg-slate-300 h-8 mb-2"></div>
                        <div id="node-advanced" class="flow-node w-full max-w-xs bg-white border-2 border-slate-300 p-3 md:p-4 rounded shadow-sm text-center relative">
                            <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 bg-amber-100 text-amber-800 text-[10px] px-2 py-0.5 rounded-full border border-amber-200">å…³é”®èŠ‚ç‚¹</div>
                            <div class="font-bold text-slate-700 text-sm md:text-base">éœ€è¦å…ç–«ç»„åŒ–/åˆ†å­æ£€æµ‹</div>
                            
                            <div id="node-use-white" class="mt-4 pt-4 border-t border-dashed border-slate-200">
                                <div class="bg-teal-50 border border-teal-200 rounded p-2 text-sm text-teal-800 font-medium">
                                    æ¶ˆè€—ç™½ç‰‡ / èœ¡å—
                                </div>
                                <div class="text-xs text-slate-400 mt-1">é‡æ–°æŸ“è‰²æ£€æµ‹</div>
                                <div class="text-xs text-teal-600 font-bold mt-2 hidden scenario-text-complex">éœ€è¦è¡¥ç¼´è´¹ç”¨</div>
                            </div>
                        </div>
                        <div class="h-6 w-0.5 bg-slate-300 mt-2"></div>
                        <div id="node-report-slow" class="flow-node w-full max-w-xs bg-white border-2 border-slate-300 p-3 md:p-4 rounded shadow-sm text-center mt-2">
                            <div class="font-bold text-slate-700 text-sm md:text-base">å‡ºå…·æœ€ç»ˆæŠ¥å‘Š</div>
                            <div class="text-xs text-teal-600 font-bold mt-2 hidden scenario-text-complex">è€—æ—¶å¢åŠ 14å¤©-30å¤©</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: Process Timeline -->
        <section id="process" class="bg-white rounded-xl shadow-lg p-5 md:p-8">
            <div class="mb-6">
                <h2 class="text-xl md:text-2xl font-bold text-slate-800 flex items-center gap-2">
                    <span class="bg-teal-100 text-teal-800 text-xs md:text-sm px-2 py-1 rounded">æµç¨‹</span>
                    é€ç‰‡å½“å¤©æ—¶é—´è½´
                </h2>
                <p class="text-sm md:text-base text-slate-500 mt-2">å½“å¤©å¦‚ä½•å®‰æ’ï¼Ÿè¯·å‚è€ƒä»¥ä¸‹æ­¥éª¤ã€‚</p>
            </div>

            <div class="space-y-6 relative border-l-2 border-slate-200 ml-3 pl-8 py-2">
                <div class="relative">
                    <div class="absolute -left-[41px] bg-teal-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold shadow-md">1</div>
                    <h3 class="font-bold text-lg text-slate-800">
                        é€ç‰‡å‰ä¸€å¤©ï¼šé¢„çº¦æŒ‚å·
                        <a href="https://imaginationsz.netlify.app/" target="_blank" class="text-teal-600 hover:text-teal-800 underline decoration-2 underline-offset-2 transition">
                            æŸ¥çœ‹åŒ»ç”Ÿç­è¡¨ 
                        </a>
                    </h3>
                    <p class="text-sm md:text-base text-slate-600 mt-1">
                        åœ¨ç½‘ä¸Šé¢„çº¦æŒ‚å·â€œç»„ç»‡ç—…ç†ä¼šè¯Šâ€ã€‚
                    </p>
                </div>

                <div class="relative">
                    <div class="absolute -left-[41px] bg-teal-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold shadow-md">2</div>
                    <h3 class="font-bold text-lg text-slate-800">åˆ°è¾¾åŒ»é™¢ï¼šç—…ç†ç§‘æŠ¥åˆ°</h3>
                    <p class="text-sm md:text-base text-slate-600 mt-1">æ— éœ€æ’é•¿é˜Ÿï¼Œåœ¨ç­‰å€™åŒºç­‰å¾…å«å·ã€‚</p>
                </div>

                <div class="relative">
                    <div class="absolute -left-[41px] bg-teal-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold shadow-md">3</div>
                    <h3 class="font-bold text-lg text-slate-800">çª—å£åŠç†ï¼šæäº¤ææ–™</h3>
                    <p class="text-sm md:text-base text-slate-600 mt-1">åˆ°çª—å£å‡ºç¤ºç”µå­å°±è¯Šå¡/åŒ»ä¿å¡ï¼Œæäº¤åˆ‡ç‰‡å’Œçº¸è´¨èµ„æ–™ã€‚</p>
                    <div class="mt-2 p-3 bg-teal-50 border border-teal-100 rounded text-sm md:text-base">
                        <span class="font-bold text-teal-800">è·å¾—å‡­è¯ï¼š</span>
                        çª—å£ä¼šè¿”è¿˜ä¸€å¼ ã€Šç—…ç†ä¼šè¯Šå‘ŠçŸ¥å•ã€‹ï¼Œå³è¿›å…¥ä¼šè¯Šæµç¨‹ã€‚
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Result Estimator -->
        <section id="result" class="bg-white rounded-xl shadow-lg p-5 md:p-8">
            <div class="mb-6">
                <h2 class="text-xl md:text-2xl font-bold text-slate-800 flex items-center gap-2">
                    <span class="bg-teal-100 text-teal-800 text-xs md:text-sm px-2 py-1 rounded">æŸ¥è¯¢</span>
                    ç»“æœé¢„æµ‹è®¡ç®—å™¨
                </h2>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-slate-50 p-4 md:p-6 rounded-lg border border-slate-200">
                    <label class="block font-bold text-slate-700 mb-2 text-sm md:text-base">æ‚¨æ˜¯å“ªå¤©é€è¿›å»çš„ï¼Ÿ</label>
                    <input type="date" id="submission-date" class="w-full p-2 border border-slate-300 rounded mb-6 focus:ring-2 focus:ring-teal-500 focus:outline-none text-slate-700">

                    <label class="block font-bold text-slate-700 mb-2 text-sm md:text-base">ç›®å‰çš„çŠ¶æ€ / æ˜¯å¦æ”¶åˆ°é€šçŸ¥ï¼Ÿ</label>
                    <div class="space-y-3">
                        <label class="flex items-center space-x-3 cursor-pointer p-3 bg-white border border-slate-200 rounded-lg hover:border-teal-400 transition">
                            <input type="radio" name="redo-status" value="no" checked class="form-radio text-teal-600 focus:ring-teal-500 h-4 w-4">
                            <span class="text-sm md:text-base text-slate-700">æš‚æ— é€šçŸ¥ / åˆšé€è¿›å»</span>
                        </label>
                        <label class="flex items-center space-x-3 cursor-pointer p-3 bg-white border border-slate-200 rounded-lg hover:border-amber-400 transition">
                            <input type="radio" name="redo-status" value="ihc" class="form-radio text-amber-600 focus:ring-amber-500 h-4 w-4">
                            <div>
                                <span class="block text-sm md:text-base font-bold text-slate-700">è¡¥è´¹é€šçŸ¥ (å…ç–«ç»„åŒ–/FISH)</span>
                                <span class="block text-xs text-slate-500">é€šå¸¸éœ€è¦åŠ åšæŸ“è‰²</span>
                            </div>
                        </label>
                        <label class="flex items-center space-x-3 cursor-pointer p-3 bg-white border border-slate-200 rounded-lg hover:border-purple-400 transition">
                            <input type="radio" name="redo-status" value="mol" class="form-radio text-purple-600 focus:ring-purple-500 h-4 w-4">
                            <div>
                                <span class="block text-sm md:text-base font-bold text-slate-700">è¡¥è´¹é€šçŸ¥ (åŸºå› æ£€æµ‹/åˆ†å­ç—…ç†)</span>
                                <span class="block text-xs text-slate-500">æµ‹åºè€—æ—¶è¾ƒé•¿</span>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="flex flex-col justify-center">
                    <div id="result-output" class="text-center p-6 bg-teal-50 border-2 border-teal-100 rounded-lg transition-colors duration-300">
                        <div class="text-sm text-teal-600 uppercase tracking-wide font-bold mb-1">é¢„è®¡å‡ºç»“æœæ—¥æœŸ</div>
                        <div id="result-date-display" class="text-3xl font-bold text-teal-800 my-2">--</div>
                        <div id="result-desc" class="text-sm text-teal-700 font-medium">è¯·é€‰æ‹©é€è¯Šæ—¥æœŸ</div>
                    </div>
                    <div class="mt-4 text-xs text-slate-400 text-center px-4">
                        *æ³¨ï¼šæ­¤æ—¶é—´ä¸ºç³»ç»Ÿæ ¹æ®å¸¸è§„æµç¨‹ä¼°ç®—ã€‚è‹¥é‡èŠ‚å‡æ—¥æˆ–ç–‘éš¾ç—…ä¾‹ï¼Œæ—¶é—´å¯èƒ½ä¼šç›¸åº”é¡ºå»¶ã€‚
                    </div>
                </div>
            </div>
        </section>

        <!-- Section: Packing Guide -->
        <section id="mail" class="bg-white rounded-xl shadow-lg p-5 md:p-8 border border-slate-100 relative overflow-hidden">
            <div class="absolute -right-10 -top-10 text-slate-50 opacity-50 pointer-events-none">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-48 w-48" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                </svg>
            </div>

            <div class="mb-6 relative z-10">
                <h2 class="text-xl md:text-2xl font-bold text-slate-800 flex items-center gap-2">
                    <span class="bg-amber-100 text-amber-800 text-xs md:text-sm px-2 py-1 rounded">æ¨è</span>
                    ğŸ“¦ åˆ‡ç‰‡å¿«é€’åŒ…è£…æŒ‡å—
                </h2>
                <p class="text-sm md:text-base text-slate-500 mt-2">
                    åˆ‡ç‰‡å¯é€‰æ‹©å¿«é€’é‚®å¯„ã€‚
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 relative z-10">
                <div class="bg-slate-50 rounded-lg p-4 border border-slate-200 hover:shadow-md transition-shadow">
                    <div class="flex items-center gap-2 mb-3">
                        <span class="bg-slate-800 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold">1</span>
                        <h3 class="font-bold text-slate-700">å†…éƒ¨å¡«å……</h3>
                    </div>
                    <p class="text-sm text-slate-600 leading-relaxed">
                        ç”¨çº¸å·¾å¡«å……åˆ‡ç‰‡ç›’å­å†…éƒ¨ç©ºéš™ï¼Œç„¶åç”¨çš®ç­‹å›ºå®šç›’å­ã€‚
                    </p>
                    <div class="mt-3 text-xs text-slate-500 bg-white p-2 rounded border border-slate-100">
                        âœ… <b>åŸåˆ™ï¼š</b> æ‘‡æ™ƒç›’å­æ—¶ï¼Œå†…éƒ¨åˆ‡ç‰‡ä¸æ™ƒåŠ¨å³å¯ã€‚
                    </div>
                </div>

                <div class="bg-slate-50 rounded-lg p-4 border border-slate-200 hover:shadow-md transition-shadow">
                    <div class="flex items-center gap-2 mb-3">
                        <span class="bg-slate-800 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold">2</span>
                        <h3 class="font-bold text-slate-700">é˜²éœ‡å¤„ç†</h3>
                    </div>
                    <p class="text-sm text-slate-600 leading-relaxed">
                        ä½¿ç”¨æ°”æ³¡è†œåŒ…è£¹åˆ‡ç‰‡ç›’å­ï¼ŒåŒ…è£¹å®Œæˆåç”¨èƒ¶å¸¦ç¼ ç»•å›ºå®šã€‚
                    </p>
                    <div class="mt-3 text-xs text-slate-500 bg-white p-2 rounded border border-slate-100">
                        ğŸ’¡ <b>æç¤ºï¼š</b> å¯ä»¥å¤šåŒ…å‡ å±‚æ°”æ³¡è†œ
                    </div>
                </div>

                <div class="bg-slate-50 rounded-lg p-4 border border-slate-200 hover:shadow-md transition-shadow">
                    <div class="flex items-center gap-2 mb-3">
                        <span class="bg-slate-800 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold">3</span>
                        <h3 class="font-bold text-slate-700">å¤–éƒ¨åŒ…è£…</h3>
                    </div>
                    <p class="text-sm text-slate-600 leading-relaxed">
                        æ‰¾ä¸€ä¸ªåšå›ºçš„çº¸ç®±ï¼Œæ”¾å…¥åŒ…è£¹å¥½çš„åˆ‡ç‰‡ã€‚å‘ŠçŸ¥å¿«é€’å°å“¥é‡Œé¢æ˜¯â€œæ˜“ç¢å“â€ã€‚
                    </p>
                    <div class="mt-3 text-xs text-slate-500 bg-white p-2 rounded border border-slate-100">
                        ğŸ“¦ <b>å»ºè®®ï¼š</b> ä½¿ç”¨é¡ºä¸°å¿«é€’ï¼Œæ›´åŠ ç¨³å¦¥ã€‚
                    </div>
                </div>
            </div>

            <div class="mt-6 bg-yellow-50 border border-yellow-100 rounded-lg p-3 flex items-start gap-3 relative z-10">
                <span class="text-xl">ğŸŒŸ</span>
                <div>
                    <div class="font-bold text-yellow-800 text-sm">åˆ‡ç‰‡ä¿å­˜å°è´´å£«</div>
                    <div class="text-xs md:text-sm text-yellow-700 mt-1">
                        åˆ‡ç‰‡å’Œèœ¡å—<b>å¸¸æ¸©ä¿å­˜</b>å³å¯ï¼Œ<b>ä¸è¦æ²¾æ°´</b>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-slate-800 text-slate-300 py-8 text-center text-xs md:text-sm">
        <p>æ­¤å·¥å…·æ ¹æ®æ‚£è€…å®¶å±ç»éªŒæ•´ç†ï¼Œä»…ä¾›å‚è€ƒã€‚</p>
        <p>å…·ä½“æµç¨‹è¯·ä»¥å¤æ—¦å¤§å­¦é™„å±è‚¿ç˜¤åŒ»é™¢æœ€æ–°å®˜æ–¹è§„å®šä¸ºå‡†ã€‚</p>
    </footer>

    <!-- å¼¹çª—éƒ¨åˆ† -->
    <div id="qrModal" class="fixed inset-0 bg-black bg-opacity-60 z-[100] hidden flex items-center justify-center p-4 backdrop-blur-sm" onclick="closeModal(event)">
        <div class="bg-white rounded-2xl p-6 max-w-sm w-full relative shadow-2xl transform transition-all scale-100" onclick="event.stopPropagation()">
            <button onclick="closeModal()" class="absolute top-3 right-4 text-gray-400 hover:text-gray-700 text-3xl font-light">&times;</button>
            <div class="text-center mt-2">
                <h3 class="text-xl font-bold text-slate-800 mb-1">æ·»åŠ å¾®ä¿¡è”ç³»</h3>
                <p class="text-sm text-slate-500 mb-4">æ‰«ä¸€æ‰«ä¸‹æ–¹äºŒç»´ç </p>
                <div class="bg-slate-50 p-6 rounded-xl border border-slate-100 mb-4 flex justify-center items-center">
                    <div id="qrcode"></div>
                </div>
                <div class="font-bold text-teal-700 text-lg">ä¸Šæµ·é™ªè¯Šå°æ²³</div>
                <div class="text-slate-500 text-sm">â˜ï¸ 17898872018</div>
            </div>
        </div>
    </div>

    <script>
        // --- Modal & QR Code ---
        function openModal() { document.getElementById('qrModal').classList.remove('hidden'); }
        function closeModal() { document.getElementById('qrModal').classList.add('hidden'); }
        
        // --- Data ---
        // highlight: true ç”¨äºé«˜äº®æ˜¾ç¤º
        // c1 (HE) å’Œ c4 (æŠ¥å‘Š) æ˜¯å¿…é¡»çš„åŸºç¡€ææ–™
        const checklistItems = [
            { id: 'c1', text: 'HEæŸ“è‰²åˆ‡ç‰‡ (ç´«è‰², å¿…éœ€)', required: true, highlight: true },
            { id: 'c2', text: 'å…ç–«ç»„åŒ–åˆ‡ç‰‡ (æ£•è‰², å¦‚æœ‰)', required: true, highlight: true },
            { id: 'c3', text: 'é«˜è´¨é‡æ¶‚èƒ¶ç™½ç‰‡15å¼  (3å¾®ç±³)æˆ– èœ¡å—', required: true },
            { id: 'c4', text: 'åŸå•ä½ç—…ç†æŠ¥å‘Š (å¿…éœ€)', required: true, highlight: true },
        ];
        const optionalItems = [
            { id: 'o1', text: 'æ‰‹æœ¯è®°å½•', highlight: true },
            { id: 'o2', text: 'å‡ºé™¢å°ç»“', highlight: true },
            { id: 'o3', text: 'å½±åƒæ£€æŸ¥æŠ¥å‘Š (CT/MRI)' },
            { id: 'o4', text: 'å…¶ä»–ç—…å²èµ„æ–™' }
        ];
        let checkedState = new Set();
        let chartInstance = null;

        document.addEventListener('DOMContentLoaded', () => {
            initChecklist();
            initChart();
            setupDateCalculator();
            document.getElementById('submission-date').valueAsDate = new Date();
            updateResultDate();
            
            if (document.getElementById("qrcode")) {
                new QRCode(document.getElementById("qrcode"), {
                    text: "https://u.wechat.com/EKcPjhL9GyGJtvlbGIc9Bbs",
                    width: 200, height: 200,
                    colorDark : "#000000", colorLight : "#ffffff",
                    correctLevel : QRCode.CorrectLevel.H
                });
            }

            // Scroll Spy
            window.addEventListener('scroll', highlightNav);
        });

        // --- Nav Highlight ---
        function highlightNav() {
            const sections = ['prep', 'logic', 'process', 'result', 'mail'];
            const scrollPos = window.scrollY + 120; // Offset

            let current = '';
            sections.forEach(id => {
                const section = document.getElementById(id);
                if (section.offsetTop <= scrollPos) {
                    current = id;
                }
            });

            document.querySelectorAll('.nav-item, .mobile-tabs button').forEach(btn => {
                btn.classList.remove('active', 'text-teal-700', 'border-teal-600', 'text-teal-600');
                btn.classList.add('text-slate-600');
                if (btn.getAttribute('onclick').includes(`'${current}'`)) {
                    btn.classList.add('active', 'text-teal-700');
                    if(btn.classList.contains('border-b-2')) { 
                         btn.classList.add('border-teal-600', 'text-teal-600');
                         btn.classList.remove('text-slate-600');
                    }
                }
            });
        }

        // --- Checklist (Highlight Logic included) ---
        function initChecklist() {
            const reqContainer = document.getElementById('checklist-container');
            const optContainer = document.getElementById('checklist-optional-container');
            
            const createItem = (item) => {
                const div = document.createElement('div');
                let wrapperClass = "flex items-start space-x-3 p-3 rounded-lg cursor-pointer transition-all border ";
                let labelClass = "font-medium text-slate-700 cursor-pointer select-none";

                if (item.highlight) {
                    wrapperClass += "bg-teal-50 border-teal-100 hover:bg-teal-100";
                    labelClass = "font-bold text-teal-800 cursor-pointer select-none";
                } else {
                    wrapperClass += "bg-transparent border-transparent hover:bg-slate-50";
                }

                div.className = wrapperClass;
                div.onclick = (e) => toggleCheck(item.id, e);
                
                div.innerHTML = `
                    <div class="relative flex items-center pt-0.5">
                        <input type="checkbox" id="${item.id}" class="peer h-5 w-5 cursor-pointer text-teal-600 rounded border-slate-300 focus:ring-teal-500" ${checkedState.has(item.id) ? 'checked' : ''}>
                    </div>
                    <div class="text-sm leading-5 w-full">
                        <label for="${item.id}" class="${labelClass} ${item.required ? 'after:content-["*"] after:ml-0.5 after:text-red-500' : ''}">
                            ${item.text}
                        </label>
                    </div>`;
                return div;
            };
            
            checklistItems.forEach(i => reqContainer.appendChild(createItem(i)));
            optionalItems.forEach(i => optContainer.appendChild(createItem(i)));
        }

        function toggleCheck(id, event) {
            if (event.target.tagName !== 'INPUT') {
                const cb = document.getElementById(id);
                cb.checked = !cb.checked;
            }
            const cb = document.getElementById(id);
            cb.checked ? checkedState.add(id) : checkedState.delete(id);
            updateChart();
        }

        // --- Chart & Logic Updated ---
        function calculatePercentage() {
            let score = 0;
            
            // æ ¸å¿ƒé€»è¾‘è°ƒæ•´ï¼š
            // c1 (HE) + c4 (æŠ¥å‘Š) = åŸºç¡€åˆ† 60 (å„å 30)
            // c2 (å…ç–«ç»„åŒ–) = 10
            // c3 (ç™½ç‰‡/èœ¡å—) = 10
            // å¯é€‰ææ–™ = 20 (æ¯ä¸ª5åˆ†)
            
            if (checkedState.has('c1')) score += 30;
            if (checkedState.has('c4')) score += 30;
            if (checkedState.has('c2')) score += 10;
            if (checkedState.has('c3')) score += 10;
            
            const optCount = optionalItems.filter(i => checkedState.has(i.id)).length;
            score += optCount * 5;

            return Math.min(score, 100);
        }

        function initChart() {
            const ctx = document.getElementById('readinessChart').getContext('2d');
            chartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['å·²å‡†å¤‡', 'æœªå‡†å¤‡'],
                    datasets: [{ data: [0, 100], backgroundColor: ['#0d9488', '#e2e8f0'], borderWidth: 0 }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false, cutout: '75%',
                    plugins: { legend: { display: false }, tooltip: { enabled: false } }
                },
                plugins: [{
                    id: 'textCenter',
                    beforeDraw: function(chart) {
                        const width = chart.width, height = chart.height, ctx = chart.ctx;
                        ctx.restore();
                        ctx.font = "bold " + (height/114).toFixed(2) + "em sans-serif";
                        ctx.textBaseline = "middle";
                        ctx.fillStyle = "#0f766e";
                        const text = Math.round(calculatePercentage()) + "%",
                            textX = Math.round((width - ctx.measureText(text).width) / 2),
                            textY = height / 2;
                        ctx.fillText(text, textX, textY);
                        ctx.save();
                    }
                }]
            });
        }

        function updateChart() {
            const percent = calculatePercentage();
            chartInstance.data.datasets[0].data = [percent, 100 - percent];
            chartInstance.update();
            const textEl = document.getElementById('readiness-text');
            const alertEl = document.getElementById('missing-alert');
            
            // æ›´æ–°åœ†ç¯ä¸­å¿ƒä¸‹æ–¹çš„æ–‡å­—
            if (percent === 100) {
                textEl.innerText = "å‡†å¤‡å®Œç¾ï¼å‡ºå‘å§ï¼";
                textEl.className = "mt-4 text-center text-sm font-bold text-teal-600";
            } else if (percent >= 60) {
                textEl.innerText = "åŸºç¡€ææ–™å·²å¤‡é½";
                textEl.className = "mt-4 text-center text-sm font-bold text-teal-600";
            } else {
                textEl.innerText = "è¯·æ ¸å¯¹å·¦ä¾§æ¸…å•";
                textEl.className = "mt-4 text-center text-sm font-medium text-slate-500";
            }
            
            // è­¦å‘Šé€»è¾‘æ›´æ–°ï¼šåªæœ‰å½“ ç¼ºå°‘HE(c1) æˆ– ç¼ºå°‘æŠ¥å‘Š(c4) æ—¶æ‰è­¦å‘Š
            const hasBasicCore = checkedState.has('c1') && checkedState.has('c4');
            
            if (!hasBasicCore) {
                alertEl.classList.remove('hidden');
                alertEl.innerText = "ç¼ºå°‘HEåˆ‡ç‰‡æˆ–ç—…ç†æŠ¥å‘Šï¼Œæ— æ³•ä¼šè¯Šï¼";
            } else {
                alertEl.classList.add('hidden');
            }
        }

        // --- Flow & Date ---
        function setScenario(scenario) {
            document.querySelectorAll('.flow-node').forEach(el => { el.classList.remove('active-path', 'opacity-50'); });
            document.querySelectorAll('.scenario-btn').forEach(el => { el.classList.remove('bg-teal-100', 'text-teal-800', 'border-teal-500'); el.classList.add('border-slate-300'); });
            document.querySelectorAll('.scenario-text-simple, .scenario-text-complex').forEach(el => el.classList.add('hidden'));

            const btn = document.getElementById('btn-' + scenario);
            btn.classList.add('bg-teal-100', 'text-teal-800', 'border-teal-500');
            btn.classList.remove('border-slate-300');

            const nodes = {
                he: document.getElementById('node-he'),
                fast: document.getElementById('node-report-fast'),
                adv: document.getElementById('node-advanced'),
                white: document.getElementById('node-use-white'),
                slow: document.getElementById('node-report-slow')
            };

            nodes.he.classList.add('active-path');
            if (scenario === 'simple') {
                nodes.fast.classList.add('active-path');
                document.querySelectorAll('.scenario-text-simple').forEach(el => el.classList.remove('hidden'));
                nodes.adv.classList.add('opacity-50'); nodes.slow.classList.add('opacity-50');
            } else {
                nodes.adv.classList.add('active-path'); nodes.slow.classList.add('active-path');
                document.querySelectorAll('.scenario-text-complex').forEach(el => el.classList.remove('hidden'));
                nodes.fast.classList.add('opacity-50');
                nodes.white.classList.add('animate-pulse');
                setTimeout(() => nodes.white.classList.remove('animate-pulse'), 2000);
            }
        }

        function setupDateCalculator() {
            document.getElementById('submission-date').addEventListener('change', updateResultDate);
            document.querySelectorAll('input[name="redo-status"]').forEach(r => r.addEventListener('change', updateResultDate));
        }

        function updateResultDate() {
            const dateInput = document.getElementById('submission-date').value;
            if (!dateInput) return;
            
            const subDate = new Date(dateInput);
            // è·å–é€‰ä¸­çš„çŠ¶æ€: 'no', 'ihc', or 'mol'
            const status = document.querySelector('input[name="redo-status"]:checked').value;
            
            const displayEl = document.getElementById('result-date-display');
            const descEl = document.getElementById('result-desc');
            const outputBox = document.getElementById('result-output');
            const formatDate = (d) => `${d.getMonth() + 1}æœˆ${d.getDate()}æ—¥`;
            
            let targetDate = new Date(subDate);

            // å¤ä½æ ·å¼
            outputBox.className = "text-center p-6 border-2 rounded-lg transition-colors duration-300";
            displayEl.className = "text-3xl font-bold my-2";

            if (status === 'no') {
                // é»˜è®¤ 7 å¤©
                targetDate.setDate(subDate.getDate() + 7);
                outputBox.classList.add('bg-teal-50', 'border-teal-100');
                displayEl.classList.add('text-teal-800');
                descEl.className = "text-sm text-teal-700 font-medium";
                
                displayEl.innerText = formatDate(targetDate) + " å‰";
                descEl.innerText = "å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œé€šå¸¸åœ¨æ­¤æ—¥æœŸå‰å‡ºç»“æœ";

            } else if (status === 'ihc') {
                // å…ç–«ç»„åŒ–/FISH: çº¦ 14 å¤©
                targetDate.setDate(subDate.getDate() + 14);
                outputBox.classList.add('bg-amber-50', 'border-amber-100');
                displayEl.classList.add('text-amber-800');
                descEl.className = "text-sm text-amber-700 font-medium";
                
                displayEl.innerText = formatDate(targetDate) + " å·¦å³";
                descEl.innerText = "å…ç–«ç»„åŒ–/FISH æ£€æµ‹å‘¨æœŸçº¦ä¸ºä¸¤å‘¨";

            } else if (status === 'mol') {
                // åŸºå› æ£€æµ‹/åˆ†å­: çº¦ 30 å¤©
                targetDate.setDate(subDate.getDate() + 30);
                outputBox.classList.add('bg-purple-50', 'border-purple-100');
                displayEl.classList.add('text-purple-800');
                descEl.className = "text-sm text-purple-700 font-medium";
                
                displayEl.innerText = formatDate(targetDate) + " å·¦å³";
                descEl.innerText = "åˆ†å­/åŸºå› æ£€æµ‹æ­¥éª¤å¤æ‚ï¼Œè€—æ—¶çº¦ä¸€ä¸ªæœˆ";
            }
        }

        function scrollToSection(id) {
            const element = document.getElementById(id);
            const headerOffset = 110; 
            const elementPosition = element.getBoundingClientRect().top;
            const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
            window.scrollTo({ top: offsetPosition, behavior: "smooth" });
        }
    </script>
</body>
</html>